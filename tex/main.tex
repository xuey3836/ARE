%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Lachaise Assignment
% LaTeX Template
% Version 1.0 (26/6/2018)
%
% This template originates from:
% http://www.LaTeXTemplates.com
%
% Authors:
% Marion Lachaise & François Févotte
% Vel (vel@LaTeXTemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\input{structure.tex} % Include the file specifying the document structure and custom commands

%----------------------------------------------------------------------------------------
%	ASSIGNMENT INFORMATION
%----------------------------------------------------------------------------------------

\title{Asymptotic Relative Efficiencies of the Score and Robust Tests in Genetic Association Studies} % Title of the assignment

\author{Yuan Xue\\ \texttt{xueyuan115@mails.ucas.ac.cn}} % Author name and email address

\date{University of Chinese Academy of Sciences--- \today} % University, school and/or department name(s) and a date

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle % Print the title

%----------------------------------------------------------------------------------------
%	INTRODUCTION
%----------------------------------------------------------------------------------------

\section{Introduction} % Unnumbered section
\subsection{notation} 

The null hypothesis is $H_0: \lambda=1$. The likeliood and log-likelihood function:
 
likelihood function: $L_n(\lambda_1,\lambda_2,\eta)$

log-likelihood function $l_n(\lambda,\eta,\theta)$

we work with $l_n(\lambda,1-\theta-+\theta\lambda,\eta)$, where $\theta$  is explicitly epressed.

\begin{align*}
x_1 = & \lambda\\
x_2= & 1-\theta-\theta\lambda\\
x_3 = & \eta
\end{align*}

Denote 

\begin{align*}
  l_{n,\mu} =& \partial l_n/\partial x_\mu \quad \text{for} \quad \mu= 1,2,3 \\
  l_{n,\mu\nu}= & \partial^2 l_n/\partial x_\mu \partial x_\nu \quad \text{for} \mu=1,2, \nu= 1,2,3\\
  l_{n,33}= & \partial^2 l_n/\partial x_3 \partial x_3\\
  l_{n,\mu\nu} = & l_{n,\nu\mu} \quad \text{for} \mu,\nu = 1,2\\
  l_{n,\mu\nu} = & l^T_{n,\nu\mu} \quad \text{for} \mu= 1,2, \nu=3\\
  L_{\mu\nu}(\eta) =& E_{H_0}(l_{1,\mu\nu}(1,1,\eta))\quad \text{for} \mu=1,2,3, \nu= 1,2,3\\
\end{align*}

$$s(\theta,\eta) = l_{1,1}(1,1,\eta)+\theta l_{1,2}(1,1,\eta)-(L_{13}^T(\eta)+\theta L_{23}^T(\eta))L_{33}^{-1}(\eta)l_{1,3}(1,1,\eta)$$
$$\mu(\lambda,\theta)=E_{H_1,\eta_0}(s(\theta,\eta_\theta))$$

\begin{align*}
\sigma(\theta) =& (I_{\lambda\lambda})^{-1}=A_{\eta_0}\theta^2+2B_{\eta_0}\theta+C_{\eta_0}\\
 A_\eta =& L_{23}(\eta)L_{33}^{-1}(\eta)L_{32}-L_{22}(\eta)\\
 B_\eta =& L_{13}(\eta)L_{33}^{-1}(\eta)L_{31}(\eta)-L_{12}(\eta)\\
 C_\eta =& L_{13}(\eta)L_{33}^{-1}(\eta)L_{31}(\theta)-L_{11}(\eta)
\end{align*}

$$\sigma(\eta,\theta_i,\theta_j) =A_{\eta}\theta_i\theta_j+B_{\eta}(\theta_i+\theta_j)+C_{\eta}$$

when $\theta = \theta^{(0)}$ is the true value $Z(\theta^{(0)})$ is the asymptotically most powerful (optimal). Let $\hat{\eta}_n$  satisfy $\partial l_n/\partial \eta|_{H_0,\hat{\eta}_n}= l_{n,3}(1,1,1,\hat{\eta}_n)=0$. Let $\eta_0$ be the true value (unknown) of $\eta$ under either $H_0$ or $H_1$, Let $\hat{\eta}_{0,n}$  be the MLE of $\eta$ under $H_0$, and $(\hat{\eta}_{1,n}, \hat{\lambda}_n)$  be that of $(\eta,\lambda)$ under $H_1$.  

\subsection{Pitman ARE}

$$e_P(Z_{MERT},Z(\theta^{(0)}))=\frac{(\rho_{\theta_i,\theta^{(0)}}+\rho_{\theta_j,\theta^{(0)}})^2}{2(1+\rho_{\theta_i,\theta_j})}$$

$$\rho_{\theta_i,\theta_j}= \frac{\sigma(\eta_0,\theta_i,\theta_j)}{{\sigma(\eta_0,\theta_i,\theta_i)\sigma(\eta_0,\theta_i,\theta_j)}^{1/2}}$$


\subsection{Chernoff ARE}


\begin{align*}
\tilde{e}_C(Z_{MERT},Z_{\theta^{(0)}})= \frac{ \tilde{Q}_{Z_{MERT}}}{\tilde{Q}_{Z_{\theta^{(0)}}}}\\
\tilde{Q}_{Z_{\theta^{(0)}}} =  2\left(1-\Phi\left(\frac{\mu^{(1)}(\lambda_0,\theta^{(0)})}{2\sigma(\theta^{(0)})}\right)\right)\\
\tilde{Q}_{Z_{MERT}} =  2\left(1-\Phi\left(\left[\frac{\mu^{(1)}(\lambda_0,\theta_i)}{2\sigma(\theta_i)}+\frac{\mu^{(1)}(\lambda_0,\theta_j)}{2\sigma(\theta_j)}\right]/\sqrt{8(1+\rho_{\theta_i,\theta_j})}\right)\right)\\
\mu^{(1)}(\lambda,\theta) = \partial \mu(\lambda,\theta)/\partial\lambda
\end{align*}
$\lambda_0 $  be the null hypothesis , $H_0: \lambda_0 \in \Lambda_0$

\subsection{Hodges-Ledmann ARE}

\begin{align*}
 e_{HL}(Z_{MERT},Z_{\theta}) =\frac{d_{Z_{MERT}}(\lambda)}{d_{Z_{\theta}(\lambda)}}\\
 d_{Z_\theta}(\lambda) =  \frac{\mu^2(\lambda,\theta)}{\sigma^2(\theta)}\\
 d_{Z_{MERT}}(\lambda) = \mu^2_{MERT}(\lambda)= [\mu(\lambda,\theta_i)/\sigma(\theta_i)+\mu(\lambda,\theta_j)/\sigma(\theta_j)]/\sqrt{2(1+\rho_{\theta_i,\theta_j})}
\end{align*}

\subsection{Bahadur ARE}

\begin{align*}
 e_{B}(Z_{MERT},Z_{\theta}) = e_{HL}(Z_{MERT},Z_{\theta})\\
 \tilde{e}_{B}(Z_{MERT},Z_{\theta}) = \frac{\tilde{c}_{Z_{MERT}}}{\tilde{c}_{Z_{\theta}}}\\
 \tilde{c}_{Z_{MERT}} = 1 - \Phi(\mu^{(1)}_{MERT}(1))\\
 \tilde{c}_{Z_{\theta}} = 1 - \Phi(\mu^{-1}(1,\theta_0)/\sigma(\theta_0))\\
 \mu(1,\theta_0) =0
\end{align*}


\subsection{Algorithm}
likelihood function

\begin{equation}
 L_n(\lambda_1,\lambda_2,\eta) = \frac{\lambda_1^{r_1}\lambda_2^{r2}exp(r\eta)}{\{1+exp(\eta)\}^{n_0}\{1+\lambda_1exp(\eta)\}^{n_1}\{1+\lambda_2exp(\eta)\}^{n_2}}
\end{equation}

log-likelihood function $l_n(\lambda,\eta,\theta)$

we work with $l_n(\lambda,1-\theta-+\theta\lambda,\eta)$, where $\theta$  is explicitly epressed.

\begin{align*}
x_1 = & \lambda\\
x_2= & 1-\theta-\theta\lambda\\
x_3 = & \eta
\end{align*}

Denote 

\begin{align*}
  l_{n,\mu} =& \partial l_n/\partial x_\mu \quad \text{for} \quad \mu= 1,2,3 \\
  l_{n,\mu\nu}= & \partial^2 l_n/\partial x_\mu \partial x_\nu \quad \text{for} \quad \mu=1,2, \nu= 1,2,3\\
  l_{n,33}= & \partial^2 l_n/\partial x_3 \partial x_3\\
  l_{n,\mu\nu} = & l_{n,\nu\mu} \quad \text{for} \quad \mu,\nu = 1,2\\
  l_{n,\mu\nu} = & l^T_{n,\nu\mu} \quad \text{for} \quad \mu= 1,2, \nu=3\\
  L_{\mu\nu}(\eta) =& E_{H_0}(l_{1,\mu\nu}(1,1,\eta))\quad \text{for} \quad \mu=1,2,3, \nu= 1,2,3\\
\end{align*}



\begin{itemize}
\item input: $Y$, $G$, $\theta^{(0)}$, $\theta_i$, $\theta_j$
\item output: $e_P(Z_{MERT},Z_{\theta^{(0)}})$, $\tilde{e}_C(Z_{MERT},Z_{\theta^{(0)}})$, $e_{HL}(Z_{MERT},Z_{\theta^{(0)}})$, $e_{B}(Z_{MERT},Z_{\theta^{(0)}})$
\end{itemize}

\begin{enumerate}[step 1]
\item Estimate $\hat{\eta}$. where $\hat{\eta}$ satisfy $\partial l_n/\partial \eta|_{H_0,\hat{\eta}_n}= l_{n,3}(1,1,\hat{\eta}_n)=0$.
\item Compute $l_n(1,1,\hat{\eta})$; $l_{n,\mu}(1,1,\hat{\eta})$, for $\mu= 1,2,3$; $l_{n,\mu\nu}(1,1,\hat{\eta})$ for $\mu= 1,2,3$, $\nu=1,2,3$.
\item Compute $L_{\mu\nu}(\hat{\eta}) = E_{H_0}(l_{1,{\mu\nu}}) ={\color{red} \frac{1}{n}l_{n,\mu\nu}(1,1,\hat{\eta}) }$
\item Compute $\sigma(\theta^{(0)})$, $\sigma(\theta_i)$, $\sigma(\theta_j), \sigma(\theta^{(0)},\theta_i), \sigma(\theta^{(0)},\theta_j), \sigma(\theta_i,\theta_j)$, where $$\sigma(\theta_i,\theta_j) =A_{\hat{\eta}}\theta_i\theta_j+B_{\hat{\eta}}(\theta_i+\theta_j)+C_{\hat{\eta}}$$
\begin{align*}
 A_\eta =& L_{23}(\eta)L_{33}^{-1}(\eta)L_{32}-L_{22}(\eta)\\
 B_\eta =& L_{13}(\eta)L_{33}^{-1}(\eta)L_{31}(\eta)-L_{12}(\eta)\\
 C_\eta =& L_{13}(\eta)L_{33}^{-1}(\eta)L_{31}(\eta)-L_{11}(\eta)
\end{align*}
\item Compute $\mu(\lambda,\theta^{(0)}),\mu(\lambda,\theta_i),\mu(\lambda,\theta_j)$,
$$\mu(\lambda,\theta)= E_{H_1,\eta_0}(s(\theta,\eta_{\theta}))= {\color{red} \frac{1}{n}(l_{n,1}(n,1,\hat{\eta})+\theta l_{n,2}(n,1,\hat{\eta})- (L_{13}^T(\eta)+\theta L_{23}^T(\eta))L_{33}^{-1}(\eta)l_{n,3}(1,1,\eta))}$$
\item Compute $\mu^{(1)}(\lambda,\theta^{(0)}),\mu^{(1)}(\lambda,\theta_i),\mu^{(1)}(\lambda,\theta_j)$,
$$\mu(\lambda,\theta)= E_{H_1,\eta_0}(s(\theta,\eta_{\theta}))= {\color{red} \frac{1}{n}(l_{n,11}(n,1,\hat{\eta})+\theta l_{n,21}(n,1,\hat{\eta})- (L_{13}^T(\hat{\eta})+\theta L_{23}^T(\hat{\eta}))L_{33}^{-1}(\hat{\eta})l_{n,31}(1,1,\hat{\eta}))}$$
\begin{align*}
\mu(\lambda,\theta)= E_{H_1,\eta_0}(s(\theta,\eta_{\theta}))=& {\color{red} \frac{1}{n}(l_{n,11}(n,1,\hat{\eta})+\theta l_{n,21}(n,1,\hat{\eta})- (L_{13}^T(\hat{\eta})+\theta L_{23}^T(\hat{\eta}))L_{33}^{-1}(\hat{\eta})l_{n,31}(1,1,\eta))}\\
= &{\color{red} L_{11}(\hat{\eta})+\theta L_{21}(\hat{\eta})- (L_{13}^T(\hat{\eta})+\theta L_{23}^T(\hat{\eta}))L_{33}^{-1}(\hat{\eta})L_{31}(\hat{\eta}))}
\end{align*}

\item Compute $e_P(Z_{MERT},Z(\theta^{(0)}))$. $$e_P(Z_{MERT},Z(\theta^{(0)}))=\frac{(\rho_{\theta_i,\theta^{(0)}}+\rho_{\theta_j,\theta^{(0)}})^2}{2(1+\rho_{\theta_i,\theta_j})}$$

$$\rho_{\theta_i,\theta_j}= \frac{\sigma(\hat{\eta},\theta_i,\theta_j)}{{\sigma(\hat{\eta},\theta_i,\theta_i)\sigma(\hat{\eta},\theta_i,\theta_j)}^{1/2}}$$

\item Compute \begin{align*}
\tilde{e}_C(Z_{MERT},Z_{\theta^{(0)}})= \frac{ \tilde{Q}_{Z_{MERT}}}{\tilde{Q}_{Z_{\theta^{(0)}}}}\\
\tilde{Q}_{Z_{\theta^{(0)}}} =  2\left(1-\Phi\left(\frac{\mu^{(1)}(\lambda_0,\theta^{(0)})}{2\sigma(\theta^{(0)})}\right)\right)\\
\tilde{Q}_{Z_{MERT}} =  2\left(1-\Phi\left(\left[\frac{\mu^{(1)}(\lambda_0,\theta_i)}{2\sigma(\theta_i)}+\frac{\mu^{(1)}(\lambda_0,\theta_j)}{2\sigma(\theta_j)}\right]/\sqrt{8(1+\rho_{\theta_i,\theta_j})}\right)\right)\\
\color{red} \lambda_0 = 1
\end{align*}

\item Compute  \begin{align*}
 e_{HL}(Z_{MERT},Z_{\theta}) =\frac{d_{Z_{MERT}}(\lambda)}{d_{Z_{\theta}(\lambda)}}\\
 d_{Z_\theta}(\lambda) =  \frac{\mu^2(\lambda,\theta)}{\sigma^2(\theta)}\\
 d_{Z_{MERT}}(\lambda) = \mu^2_{MERT}(\lambda)= [\mu(\lambda,\theta_i)/\sigma(\theta_i)+\mu(\lambda,\theta_j)/\sigma(\theta_j)]/\sqrt{2(1+\rho_{\theta_i,\theta_j})}
\end{align*}

\item Compute  \begin{align*}
 e_{B}(Z_{MERT},Z_{\theta}) = e_{HL}(Z_{MERT},Z_{\theta})\\
 \tilde{e}_{B}(Z_{MERT},Z_{\theta}) = \frac{\tilde{c}_{Z_{MERT}}}{\tilde{c}_{Z_{\theta}}}\\
 \tilde{c}_{Z_{MERT}} = 1 - \Phi(\mu^{(1)}_{MERT}(1))\\
 \tilde{c}_{Z_{\theta}} = 1 - \Phi(\mu^{-1}(1,\theta^{(0)})/\sigma(\theta^{(0)})) 
\end{align*}
\end{enumerate}

\end{document}
